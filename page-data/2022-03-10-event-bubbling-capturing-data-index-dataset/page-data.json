{
    "componentChunkName": "component---src-templates-post-template-tsx",
    "path": "/2022-03-10-event-bubbling-capturing-data-index-dataset/",
    "result": {"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<p>이 글은 <a href=\"https://programmers.co.kr/learn/courses/13545\" target=\"_blank\" rel=\"nofollow\">prgms-vanilla-js 스터디</a>를 진행하며 습득한 이벤트 버블링을 포함한 이벤트 캡쳐, 위임, 이벤트에 관련한 이슈들을 다룬다.</p>\n<h2>1. js에서 이벤트 등록</h2>\n<p>동적인 웹 페이지를 만들기 위해 우리는 js에서 이벤트를 다룬다.</p>\n<p>프론트엔드쪽 개발을 해본 사람이라면 event객체를 다뤄본적이 다들 있을 것이다.</p>\n<p>우리는 특정 html태그에 event를 넣어 event를 다룬다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">개발 나무 심기</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>라는 태그에 이벤트를 넣어보자</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">var</span> titleBtn <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'button'</span><span class=\"token punctuation\">)</span>\nbutton<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'개발 나무 심기'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>이런 식으로 이벤트를 등록할 수 있다.</p>\n<h2>2. 이벤트 버블링</h2>\n<p>혹시 js를 사용하다가 의도치 않게 유저의 행동 하나에 두 개 이상의 이벤트가 일어난 적이 있다면 이는 이벤트 버블링 때문일 확률이 높다.</p>\n<p>dom에서의 이벤트는 상위 컴포넌트로 전달되는 방식으로 움직인다.</p>\n<p>그러기 때문에 혹시 이벤트가 여러 개의 하위 태그나 상위태그에 등록이 돼 있다면 이벤트가 버블링 되는 과정에서 그 이벤트들이 발생되는 것이다.</p>\n<h2>이벤트 버블링 어떻게 해결할까?</h2>\n<h3>1. event.stopPropagation()</h3>\n<p>구조를 바꿔서 필요한 곳에만 이벤트가 발생하게 해야하는 해결책이 제일 필요하지만 우리는 이벤트를 섬세하게 다룰 때 문제가 생기는 상황도 생각을 해야하다고 해보자</p>\n<p>그럴 땐 그저 이벤트가 발생은 하되 버블링이 안되는 함수가 있다면 편할 것이다.</p>\n<p>그 함수가 바로 event.stoppropagation()함수이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// 사용 예시</span>\nelements<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">element</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  element<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    e<span class=\"token punctuation\">.</span><span class=\"token function\">stopPropagation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'hi'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3>2. 이벤트 위임</h3>\n<p>이벤트 위임은 앞으로 생기는 모든 내가 원하는 태그에 대해서 자동으로 이벤트가 생길 수 있게 만드는 방식이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">var</span> itemList <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.itemList'</span><span class=\"token punctuation\">)</span>\nitemList<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListner</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">event</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'hi'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3>3. <a href=\"http://e.target\" target=\"_blank\" rel=\"nofollow\">e.target</a> 내부를 이용</h3>\n<p>click event의 target 객체안에는 closest라는 함수가 있다. 이 함수는 매개변수 태그에 해당하는 가장 가까운 dom 요소를 반환한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>$todoList<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">e</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> $li <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span><span class=\"token function\">closest</span><span class=\"token punctuation\">(</span><span class=\"token string\">'li'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> index <span class=\"token operator\">=</span> <span class=\"token function\">Number</span><span class=\"token punctuation\">(</span>$li<span class=\"token punctuation\">.</span>dataset<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>tagName <span class=\"token operator\">===</span> <span class=\"token string\">'LI'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">onTodoClick</span><span class=\"token punctuation\">(</span>index<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>tagName <span class=\"token operator\">===</span> <span class=\"token string\">'BUTTON'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">onTodoRemove</span><span class=\"token punctuation\">(</span>index<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>const index를 보면 $li요소에 dataset에 index를 꺼내는것을 볼 수 있는데</p>\n<p>해당 클래스에 render함수를 확인해보자</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function-variable function\">render</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Array<span class=\"token punctuation\">.</span><span class=\"token function\">isArray</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>$todoList<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state\n      <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>\n        <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> text<span class=\"token punctuation\">,</span> isCompleted <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> index</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n          <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;li data-index=\"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>index<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\"></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>\n            isCompleted <span class=\"token operator\">?</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;s></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>text<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&lt;/s></span><span class=\"token template-punctuation string\">`</span></span> <span class=\"token operator\">:</span> text\n          <span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> &lt;button>✅&lt;/button>&lt;/li></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이런 식으로 데 data와 -를 이용하여 태그에 삽입하면 dataset에서 해당 정보를 가져올 수 있다.</p>\n<p>다시 이벤트를 다루는 방식으로 보면 click 이벤트를 등록할 때 closest 등의 내장 함수를 이용하여 버블링을 다룰 수 있다.</p>\n<p>또 e.target안에 있는 tagName으로 클릭한 곳에 태그를 찾아 이벤트를 발생시킬 수 있다.</p>\n<h2>이벤트 캡쳐</h2>\n<p>이벤트 캡쳐는 이벤트 버블링의 “역”이다.</p>\n<p>버블링이 하위태그부터 상위태그를 타고 갔다면 캡쳐는 상위태그에서 하위태그를 타고 내려온다.</p>\n<p>그렇다면 버블링이 아닌 캡쳐링으로 이벤트를 핸들링 하려면 어떻게 해야하는가?</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">var</span> lists <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelectorAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">'li'</span><span class=\"token punctuation\">)</span>\nlists<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">div</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  list<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> Event<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    capture<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>따로 설정하지 않으면 capture의 default값은 false이다.</p>\n<p>이벤트를 다루는 방식중 버블링, 위임, 이벤트 생성 시 발생할 수 있는 문제 해결 방법, 캡쳐링등을 다뤄보았다.</p>\n<p>이벤트에 전파 방식을 알고 문제가 생기면 dom을 섬세히 다루며 해결하는 방식으로 해결하는 게 이벤트를 다루는 좋은 방법 중 하나인 것 같다.</p>\n<p>글에 대한 내용이 미숙하거나 잘못됨이 있을 수 있으니 댓글 달아주시면 수정하겠습니다.</p>\n<p>읽어주셔 감사합니다.</p>","frontmatter":{"title":"바닐라 js로 이벤트 핸들링","summary":"이벤트 등록, 버블링, 캡쳐링, data-index 활용","date":"2022.03.10.","categories":["js"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAs0lEQVQoz2P4f6uGbMRAE83/blb/vVn971bNP5I136z5f6/u//36/7dr/t+pJUEzyKo7tS+OFT45nP/rWuX3yxX/b9cSq/nvjer/jxsPLI2f3+E7vdFz14Lo/w8a/t6sJqz5382a/7dr/t6sntHstWtB9Ixm7yn1Hv8fEqcZim7X3NyZ+eFs6Z092R/Olv6/U/uPtKh62PDvTu3/Bw3/79aCwo8kzX9vVP+7CSXpm0iI0QwAzokn9sRdXPEAAAAASUVORK5CYII="},"images":{"fallback":{"src":"/static/8add42706d9936c8c0866ce13efe8b0a/2ee73/vanilla.png","srcSet":"/static/8add42706d9936c8c0866ce13efe8b0a/10d63/vanilla.png 71w,\n/static/8add42706d9936c8c0866ce13efe8b0a/e45ee/vanilla.png 142w,\n/static/8add42706d9936c8c0866ce13efe8b0a/2ee73/vanilla.png 284w","sizes":"(min-width: 284px) 284px, 100vw"},"sources":[{"srcSet":"/static/8add42706d9936c8c0866ce13efe8b0a/1d6d0/vanilla.webp 71w,\n/static/8add42706d9936c8c0866ce13efe8b0a/147bb/vanilla.webp 142w,\n/static/8add42706d9936c8c0866ce13efe8b0a/033a8/vanilla.webp 284w","type":"image/webp","sizes":"(min-width: 284px) 284px, 100vw"}]},"width":284,"height":177}},"publicURL":"/static/8add42706d9936c8c0866ce13efe8b0a/vanilla.png"}}}}]}},"pageContext":{"slug":"/2022-03-10-event-bubbling-capturing-data-index-dataset/"}},
    "staticQueryHashes": []}